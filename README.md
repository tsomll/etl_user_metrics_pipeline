ETL User Metrics Pipeline
Описание проекта
Этот проект реализует ежедневный ETL-процесс с помощью Apache Airflow для агрегации пользовательской активности из двух источников: feed_actions и message_actions. Финальные метрики сохраняются в таблицу ClickHouse и обновляются ежедневно.

Цель
Построить автоматизированный пайплайн, который:
Считает метрики по действиям пользователей за каждый предыдущий день
Делает агрегации по ключевым срезам (пол, возраст, операционная система)
Записывает результат в финальную таблицу в ClickHouse

Источники данных
feed_actions
Используется для расчёта количества просмотров и лайков контента на пользователя.

message_actions
Используется для расчёта:
количества отправленных и полученных сообщений
числа уникальных пользователей, от которых пришли сообщения
числа уникальных пользователей, которым были отправлены сообщения

Этапы DAG
Извлечение данных

feed_actions: просмотры и лайки
message_actions: сообщения и уникальные пользователи

Объединение данных
Объединение агрегированных таблиц по user_id
Агрегации по срезам
Отдельные таски для разрезов по:

полу (gender)
возрасту (age)
операционной системе (os)
Загрузка в ClickHouse

Итоговая таблица пополняется ежедневно
Схема финальной таблицы:
event_date
dimension
dimension_value
views
likes
messages_received
messages_sent
users_received
users_sent

Используемые технологии
Python
Apache Airflow
ClickHouse
SQL
